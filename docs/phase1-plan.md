# Phase 1 実装計画詳細

**期間:** Week 5-12（8週間）
**目標:** MVP（Minimum Viable Product）の完成と本番環境リリース
**最終更新日:** 2025-10-24

---

## 🎯 Phase 1のゴール

1. ✅ 自動Campaign作成機能の実装
2. ✅ 基本最適化エンジン（ルールベース）の実装
3. ✅ アラート・通知機能の実装
4. ✅ 権限管理（RBAC）の実装
5. ✅ 本番環境への移行と稼働開始

---

## 📋 優先順位付きタスクリスト

### Week 5: 技術的負債解消 + データモデル完成

**🔴 Critical（必須）**
1. OAuth State ランダム化実装（2日）
2. エラーハンドリング統一（2日）
3. トークン自動リフレッシュ機構（1日）

**🟡 High**
4. データモデル全体のレビュー（1日）
5. Creative/AdGroup/Ad テーブルの最終確認（1日）

**成果物:**
- セキュリティ強化完了
- ERD最終版

---

### Week 6-7: Creative Management & AdGroup/Ad 作成

**主要タスク:**
1. **Creative Management実装**（Week 6）
   - ファイルアップロード機能
   - Vercel Blob Storage連携
   - メタデータ抽出（FFmpeg）
   - Creative一覧・プレビューUI
   - 所要時間: 5日

2. **AdGroup CRUD API実装**（Week 6後半）
   - POST /adgroup/create
   - GET /adgroup/get
   - POST /adgroup/update
   - ターゲティング設定UI
   - 所要時間: 2日

3. **Ad CRUD API実装**（Week 7前半）
   - POST /ad/create
   - GET /ad/get
   - POST /ad/update
   - Creative紐付け機能
   - 所要時間: 2日

4. **パラメータバリデーション強化**（Week 7後半）
   - 必須項目チェック
   - 整合性チェック
   - ポリシー違反チェック
   - 所要時間: 1日

**成果物:**
- Creative管理画面
- AdGroup/Ad作成フォーム
- 動画アップロード機能

---

### Week 7-8: キャンペーン自動作成フロー

**主要タスク:**
1. **テンプレート機能**（Week 7後半）
   - 目標別プリセット作成
   - テンプレートDB保存
   - カスタムテンプレート作成UI
   - 所要時間: 2日

2. **推奨設定ロジック**（Week 8前半）
   - 予算推奨アルゴリズム
   - 入札推奨ロジック
   - ターゲティング推奨
   - 所要時間: 2日

3. **ワンクリック作成フロー**（Week 8前半）
   - Campaign → AdGroup → Ad 一括作成
   - トランザクション制御
   - 作成進捗表示UI
   - 所要時間: 2日

4. **下書き・承認機能**（Week 8後半）
   - 下書き保存機能
   - 承認フロー実装
   - 承認者通知
   - 所要時間: 1日

**成果物:**
- テンプレートライブラリ
- ワンクリック作成機能
- 承認フローUI

---

### Week 8-9: 基本最適化エンジン（ルールベース）

**主要タスク:**
1. **最適化ジョブ基盤**（Week 8後半）
   - BullMQセットアップ
   - スケジューラー実装（2時間ごと）
   - Worker Pool設定
   - 所要時間: 2日

2. **パフォーマンス評価ロジック**（Week 9前半）
   - 過去N時間のデータ取得
   - CPA, CTR, CVR 計算
   - 目標値との比較
   - 所要時間: 1日

3. **予算再配分ルール**（Week 9前半）
   - 高パフォーマンス → 予算増額
   - 低パフォーマンス → 予算減額
   - 上限・下限チェック
   - 所要時間: 1日

4. **入札調整・停止ルール**（Week 9中盤）
   - CPA高騰時の対応
   - 学習停滞時の切替
   - 自動停止ロジック
   - 所要時間: 1日

5. **変更記録・監査ログ**（Week 9後半）
   - ChangeLogテーブル記録
   - 最適化理由の保存
   - 履歴表示UI
   - 所要時間: 1日

**成果物:**
- 自動最適化エンジン
- 最適化履歴ダッシュボード

---

### Week 9-10: アラート・通知 & 権限管理

**主要タスク:**
1. **Slack連携**（Week 9後半）
   - Slack App作成
   - Webhook URL設定
   - メッセージフォーマット設計
   - 所要時間: 1日

2. **アラートルール定義**（Week 10前半）
   - CPA逸脱アラート
   - 予算消化率異常検知
   - API連続失敗アラート
   - 審査落ちアラート
   - 所要時間: 2日

3. **RBAC実装**（Week 10前半）
   - Role定義（Viewer/Operator/Approver/Admin）
   - Permission定義
   - 認可ミドルウェア
   - 所要時間: 2日

4. **通知設定UI**（Week 10後半）
   - ユーザーごとの通知ON/OFF
   - 通知チャンネル選択
   - 閾値カスタマイズ
   - 所要時間: 1日

**成果物:**
- Slack通知機能
- アラートダッシュボード
- 権限管理画面

---

### Week 10-11: 可観測性・ロギング & 本番環境構築

**主要タスク:**
1. **構造化ログ実装**（Week 10後半）
   - JSON形式ログ出力
   - レベル別出力
   - リクエストID付与
   - 所要時間: 1日

2. **メトリクス収集**（Week 11前半）
   - API呼出数・エラー率
   - レイテンシ測定
   - レート制限到達率
   - 所要時間: 1日

3. **Vercel本番環境構築**（Week 11前半）
   - Vercel Projectセットアップ
   - Neon Postgres（本番）
   - Upstash Redis（本番）
   - Vercel Blob Storage
   - 所要時間: 2日

4. **Secrets管理**（Week 11中盤）
   - Vercel Environment Variables
   - TikTok API Key設定
   - DB認証情報設定
   - 所要時間: 1日

5. **デプロイパイプライン**（Week 11後半）
   - GitHub → Vercel自動デプロイ
   - Preview Deployments
   - Production Deployments
   - Smoke Test
   - 所要時間: 1日

**成果物:**
- 本番環境（Vercel）
- CI/CDパイプライン
- 監視ダッシュボード

---

### Week 11-12: Sandbox→本番移行 & Phase 1振り返り

**主要タスク:**
1. **TikTok App Review申請**（Week 11後半）
   - 本番環境URL登録
   - Privacy Policy作成
   - スクリーンショット提出
   - 審査対応
   - 所要時間: 2-3日（審査待ち含む）

2. **本番APIキー取得・設定**（Week 12前半）
   - 本番 advertiser_id 登録
   - OAuth Production URL 切替
   - 所要時間: 1日

3. **本番環境疎通テスト**（Week 12前半）
   - OAuth認証
   - Campaign作成
   - Reporting取得
   - 最適化ジョブ実行
   - 所要時間: 1日

4. **MVPデモ・ユーザートレーニング**（Week 12中盤）
   - 運用担当者トレーニング
   - 操作マニュアル作成
   - 所要時間: 1日

5. **受け入れテスト**（Week 12後半）
   - 10件Campaign自動作成テスト
   - 成功率95%以上確認
   - アラート動作確認
   - 所要時間: 1日

**成果物:**
- 本番稼働開始
- 操作マニュアル
- Phase 1完了報告書

---

## 🎯 マイルストーン

| マイルストーン | 完了日 | 成果物 |
|--------------|--------|--------|
| 技術的負債解消 | Week 5終了 | セキュリティ強化完了 |
| Creative管理完成 | Week 6終了 | Creative管理画面 |
| AdGroup/Ad API完成 | Week 7終了 | AdGroup/Ad作成フォーム |
| 自動作成フロー完成 | Week 8終了 | ワンクリック作成機能 |
| 最適化エンジン完成 | Week 9終了 | 自動最適化稼働 |
| アラート・権限完成 | Week 10終了 | Slack通知・RBAC |
| 本番環境構築完了 | Week 11終了 | Vercel本番環境 |
| **Phase 1完了** | **Week 12終了** | **MVP稼働開始** |

---

## ⚠️ リスクと対策

### リスク1: TikTok App Review遅延

**影響:** 本番リリース遅延
**対策:** 
- Week 11前半で早期申請
- Sandbox環境で並行テスト継続

### リスク2: 最適化アルゴリズムの精度不足

**影響:** ROI改善効果が限定的
**対策:**
- ルールベースでまず稼働
- Phase 2でAI最適化を追加

### リスク3: スケーラビリティ問題

**影響:** 大量Campaign対応不可
**対策:**
- Week 10でパフォーマンステスト実施
- ボトルネック特定・改善

---

## 📊 成功指標（Phase 1完了時）

| 指標 | 目標値 |
|------|--------|
| Campaign自動作成成功率 | ≥ 95% |
| 最適化ジョブ成功率 | ≥ 99.9% |
| API成功率 | ≥ 99.5% |
| CPA改善率 | ≥ 10% |
| 運用工数削減率 | ≥ 50% |

---

## 📚 参考資料

- [実装タスク一覧.txt](../実装タスク一覧.txt)
- [技術的負債リスト](./technical-debt.md)
- [ERD設計ドキュメント](./erd-design.md)
- [API仕様書](./api-spec.md)

---

**作成日:** 2025-10-24
**次の更新:** Week 5開始時に詳細スケジュール確定
